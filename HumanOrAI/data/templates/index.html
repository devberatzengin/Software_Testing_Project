<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Dedektör Pro</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body {
            background-color: #f0f2f5;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .sidebar {
            background: white;
            border-radius: 15px;
            padding: 25px;
            height: 100%;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .main-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .verdict-box {
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            color: white;
            margin-bottom: 20px;
        }

        .bg-ai {
            background: linear-gradient(45deg, #ff6b6b, #ee5253);
        }

        .bg-human {
            background: linear-gradient(45deg, #1dd1a1, #10ac84);
        }

        .model-card {
            border-left: 4px solid #ccc;
            background: #fafafa;
            margin-bottom: 10px;
            transition: 0.3s;
        }

        .model-card:hover {
            transform: translateX(5px);
        }
    </style>
</head>

<body class="py-4">

    <div class="container">
        <div class="row mb-4">
            <div class="col-12 text-center">
                <h2 class="fw-bold text-primary"><i class="bi bi-robot"></i> AI vs İnsan Tespit Sistemi</h2>
                <p class="text-muted">Makine Öğrenmesi Tabanlı Metin Analizi</p>
            </div>
        </div>

        <form method="POST" action="/">
            <div class="row">
                <div class="col-md-4 mb-4">
                    <div class="sidebar">
                        <h5 class="fw-bold mb-3"><i class="bi bi-sliders"></i> Model Seçimi</h5>
                        <p class="small text-muted">Analizde kullanılacak algoritmaları seçiniz:</p>

                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" name="models" value="Logistic Regression"
                                id="m1" {% if 'Logistic Regression' in selected_models %}checked{% endif %}>
                            <label class="form-check-label" for="m1">Logistic Regression</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" name="models" value="Naive Bayes" id="m2" {%
                                if 'Naive Bayes' in selected_models %}checked{% endif %}>
                            <label class="form-check-label" for="m2">Naive Bayes (Olasılıksal)</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" name="models" value="Random Forest" id="m3"
                                {% if 'Random Forest' in selected_models %}checked{% endif %}>
                            <label class="form-check-label" for="m3">Random Forest (Karar Ağacı)</label>
                        </div>

                        <hr>
                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary"><i class="bi bi-search"></i> Analiz
                                Et</button>
                            <a href="/reset" class="btn btn-outline-secondary"><i
                                    class="bi bi-arrow-counterclockwise"></i> Sıfırla</a>
                        </div>
                    </div>
                </div>

                <div class="col-md-8">
                    <div class="main-content">
                        <div class="mb-3">
                            <label class="form-label fw-bold">Makale Özeti / Metin:</label>
                            <textarea class="form-control bg-light" name="text_input" rows="6"
                                placeholder="Analiz edilecek metni buraya yapıştırın..."
                                required>{{ input_text }}</textarea>
                        </div>

                        {% if result %}
                        {% if result.error %}
                        <div class="alert alert-danger">{{ result.error }}</div>
                        {% else %}
                        <hr class="my-4">

                        <div
                            class="verdict-box {% if result.final_verdict == 'AI' %}bg-ai{% else %}bg-human{% endif %}">
                            <h3 class="mb-0">SONUÇ: {{ result.final_verdict }}</h3>
                            <small>Ortalama Güven Skoru</small>
                        </div>

                        <div class="row">
                            <div class="col-md-5 mb-3">
                                <canvas id="resultChart"></canvas>
                            </div>

                            <div class="col-md-7">
                                <h6 class="fw-bold">Model Tahminleri:</h6>
                                {% for item in result.individual_results %}
                                <div class="card p-2 model-card"
                                    style="border-left-color: {% if item.label == 'AI' %}#ee5253{% else %}#10ac84{% endif %};">
                                    <div class="d-flex justify-content-between">
                                        <span>{{ item.model_name }}</span>
                                        {% if item.status == 'error' %}
                                        <span class="badge bg-warning text-dark">HATA (Sürüm)</span>
                                        {% else %}
                                        <span
                                            class="badge {% if item.label == 'AI' %}bg-danger{% else %}bg-success{% endif %}">
                                            {{ item.label }} %{{ item.confidence }}
                                        </span>
                                        {% endif %}
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        {% endif %}
                        {% endif %}
                    </div>
                </div>
            </div>
        </form>
    </div>

    {% if result and not result.error %}
    <script>
        const ctx = document.getElementById('resultChart').getContext('2d');
        new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['Yapay Zeka (AI)', 'İnsan (Human)'],
                datasets: [{
                    data: [{{ result.stats.avg_ai }}, {{ result.stats.avg_human }}],
            backgroundColor: ['#ff6b6b', '#1dd1a1'],
            borderWidth: 0
        }]
        },
            options: {
            responsive: true,
            plugins: {
                legend: { position: 'bottom' },
                title: { display: true, text: 'Ortalama Olasılık Dağılımı' }
            }
        }
    });
    </script>
    {% endif %}

</body>

</html>